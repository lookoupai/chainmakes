# OKX å®ç›˜äº¤æ˜“åˆ‡æ¢æŒ‡å—

## ğŸ“š æ¨¡æ‹Ÿç›˜ vs å®ç›˜è¯´æ˜

### å½“å‰çŠ¶æ€

ä½ çš„é¡¹ç›®**ç›®å‰ä½¿ç”¨ OKX æ¨¡æ‹Ÿç›˜ API** è¿›è¡Œæµ‹è¯•ã€‚

### å…³é”®ä»£ç é€»è¾‘

#### 1. æ¨¡æ‹Ÿç›˜/å®ç›˜æ§åˆ¶å‚æ•°

åœ¨ `backend/app/exchanges/okx_exchange.py:66-109`:

```python
def __init__(self, api_key: str, api_secret: str, passphrase: str,
             is_testnet: bool = True, proxy: str = None):
    """
    is_testnet: æ˜¯å¦ä½¿ç”¨æ¨¡æ‹Ÿç›˜
    - True  = æ¨¡æ‹Ÿç›˜ (é»˜è®¤)
    - False = çœŸå®ç›˜
    """
    self.is_testnet = is_testnet

    # è®¾ç½®æ¨¡æ‹Ÿç›˜/çœŸå®ç›˜
    if self.is_testnet:
        config['sandbox'] = True  # æ¨¡æ‹Ÿç›˜
        logger.info("âœ… ä½¿ç”¨ OKX æ¨¡æ‹Ÿç›˜ç¯å¢ƒ")
    else:
        logger.info("âš ï¸ ä½¿ç”¨ OKX çœŸå®ç›˜ç¯å¢ƒ")
```

#### 2. é»˜è®¤é…ç½®æ¥æº

åœ¨ `backend/app/exchanges/exchange_factory.py:70-78`:

```python
if exchange_name == 'okx':
    # å¦‚æœæœªæ˜ç¡®ä¼ å…¥,åˆ™ä»é…ç½®è¯»å–
    if is_testnet is None:
        is_testnet = settings.OKX_IS_DEMO  # è¯»å–ç¯å¢ƒå˜é‡

    kwargs['is_testnet'] = is_testnet
```

**å…³é”®ç‚¹**: `is_testnet` å‚æ•°**ä»…ä»ç¯å¢ƒå˜é‡ `OKX_IS_DEMO` è¯»å–**,ä¸åœ¨å‰ç«¯è®¾ç½®ã€‚

---

## ğŸ¯ å¦‚ä½•åˆ‡æ¢åˆ°å®ç›˜äº¤æ˜“?

### âš ï¸ é‡è¦æé†’

**åœ¨åˆ‡æ¢å®ç›˜å‰,å¿…é¡»ç¡®ä¿**:

1. âœ… å·²å……åˆ†åœ¨æ¨¡æ‹Ÿç›˜æµ‹è¯•
2. âœ… ç­–ç•¥å‚æ•°å·²ä¼˜åŒ–
3. âœ… ç†è§£çœŸå®èµ„é‡‘é£é™©
4. âœ… è®¾ç½®åˆç†çš„æ­¢æŸå’Œä»“ä½é™åˆ¶
5. âœ… **ä½¿ç”¨å°é¢èµ„é‡‘æµ‹è¯•**

---

## ğŸ“ å®Œæ•´åˆ‡æ¢æ­¥éª¤

### æ­¥éª¤ 1: å‡†å¤‡ OKX å®ç›˜ API

#### 1.1 ç™»å½• OKX å®˜ç½‘

- è®¿é—®: https://www.okx.com
- ç™»å½•ä½ çš„è´¦æˆ·

#### 1.2 åˆ›å»º API å¯†é’¥

1. å³ä¸Šè§’ **å¤´åƒ** â†’ **API**
2. ç‚¹å‡» **åˆ›å»º V5 API Key**
3. å¡«å†™ä¿¡æ¯:
   - **API åç§°**: ç»™ä¸ªå®¹æ˜“è¯†åˆ«çš„åå­—,å¦‚ `TradingBot`
   - **API å¯†ç **: è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç  (è¿™æ˜¯ Passphrase)
   - **æƒé™**:
     - âœ… **è¯»å–** (å¿…é€‰)
     - âœ… **äº¤æ˜“** (å¿…é€‰)
     - âš ï¸ ä¸è¦å‹¾é€‰ **æå¸** (å®‰å…¨è€ƒè™‘)
   - **IP ç™½åå•**:
     - å»ºè®®ç»‘å®šæœåŠ¡å™¨ IP
     - æµ‹è¯•æœŸé—´å¯æš‚æ—¶ç•™ç©º
4. å®ŒæˆéªŒè¯ (é‚®ç®±/æ‰‹æœº/è°·æ­ŒéªŒè¯)
5. **ç«‹å³å¤åˆ¶å¹¶ä¿å­˜**:
   - API Key
   - Secret Key
   - Passphrase

**æ³¨æ„**: Secret Key **åªæ˜¾ç¤ºä¸€æ¬¡**,è¯·å¦¥å–„ä¿å­˜!

#### 1.3 OKX æ¨¡æ‹Ÿç›˜ vs å®ç›˜ API åŒºåˆ«

| é¡¹ç›® | æ¨¡æ‹Ÿç›˜ API | å®ç›˜ API |
|------|-----------|---------|
| è·å–ä½ç½® | OKX â†’ æ¨¡æ‹Ÿäº¤æ˜“ â†’ API | OKX â†’ API |
| èµ„é‡‘ | è™šæ‹Ÿèµ„é‡‘ | çœŸå®èµ„é‡‘ |
| æ•°æ® | çœŸå®è¡Œæƒ… | çœŸå®è¡Œæƒ… |
| è®¢å• | æ¨¡æ‹Ÿæ‰§è¡Œ | çœŸå®æ‰§è¡Œ |
| è´¹ç”¨ | æ—  | æœ‰äº¤æ˜“æ‰‹ç»­è´¹ |
| API ç«¯ç‚¹ | `www.okx.com/api` (sandbox=true) | `www.okx.com/api` (sandbox=false) |

**é‡ç‚¹**: æ¨¡æ‹Ÿç›˜å’Œå®ç›˜ä½¿ç”¨**åŒä¸€ä¸ª API ç«¯ç‚¹**,åŒºåˆ«åœ¨äº CCXT çš„ `sandbox` å‚æ•°!

---

### æ­¥éª¤ 2: ä¿®æ”¹ç¯å¢ƒå˜é‡

#### 2.1 ç¼–è¾‘ `.env` æ–‡ä»¶

```bash
vim .env
```

#### 2.2 æ·»åŠ å®ç›˜é…ç½®

```bash
# ========================================
# OKX å®ç›˜é…ç½® (âš ï¸ é£é™©è­¦å‘Š)
# ========================================
# åˆ‡æ¢åˆ°å®ç›˜: è®¾ç½®ä¸º false
OKX_IS_DEMO=false

# ä»£ç†é…ç½® (å›½å†…éœ€è¦)
OKX_PROXY=http://127.0.0.1:7890
```

**é‡è¦**:
- `OKX_IS_DEMO=false` è¡¨ç¤ºä½¿ç”¨å®ç›˜
- `OKX_IS_DEMO=true` è¡¨ç¤ºä½¿ç”¨æ¨¡æ‹Ÿç›˜ (é»˜è®¤)

---

### æ­¥éª¤ 3: åœ¨å‰ç«¯æ·»åŠ å®ç›˜ API

#### 3.1 ç™»å½•ç³»ç»Ÿ

è®¿é—®: http://localhost:3333 (æˆ–ä½ çš„æœåŠ¡å™¨åœ°å€)

#### 3.2 æ·»åŠ äº¤æ˜“æ‰€è´¦æˆ·

1. ç‚¹å‡»å·¦ä¾§èœå• **äº¤æ˜“æ‰€ç®¡ç†**
2. ç‚¹å‡» **æ·»åŠ äº¤æ˜“æ‰€**
3. å¡«å†™ä¿¡æ¯:
   - **äº¤æ˜“æ‰€**: é€‰æ‹© `OKX`
   - **API Key**: ç²˜è´´å®ç›˜ API Key
   - **API Secret**: ç²˜è´´å®ç›˜ Secret Key
   - **Passphrase**: ç²˜è´´å®ç›˜ Passphrase
4. ç‚¹å‡» **æµ‹è¯•è¿æ¥**
   - âœ… æˆåŠŸ: æ˜¾ç¤ºè´¦æˆ·ä½™é¢
   - âŒ å¤±è´¥: æ£€æŸ¥ API å¯†é’¥å’Œç½‘ç»œ

**æ³¨æ„**:
- å‰ç«¯åªéœ€è¦å¡«å†™ API å¯†é’¥
- **ä¸éœ€è¦åœ¨å‰ç«¯é€‰æ‹©æ¨¡æ‹Ÿç›˜/å®ç›˜**
- æ¨¡æ‹Ÿç›˜/å®ç›˜ç”± `.env` ä¸­çš„ `OKX_IS_DEMO` æ§åˆ¶

---

### æ­¥éª¤ 4: é‡å¯æœåŠ¡

#### 4.1 Docker éƒ¨ç½²

```bash
# é‡å¯åç«¯æœåŠ¡ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ
docker-compose restart backend

# æŸ¥çœ‹æ—¥å¿—ç¡®è®¤
docker-compose logs -f backend
```

æŸ¥çœ‹æ—¥å¿—ä¸­çš„æç¤º:
- âœ… æ¨¡æ‹Ÿç›˜: `âœ… ä½¿ç”¨ OKX æ¨¡æ‹Ÿç›˜ç¯å¢ƒ (sandbox mode)`
- âš ï¸ å®ç›˜: `âš ï¸ ä½¿ç”¨ OKX çœŸå®ç›˜ç¯å¢ƒ`

#### 4.2 æœ¬åœ°å¼€å‘

```bash
# åœæ­¢åç«¯
# Ctrl+C

# é‡æ–°å¯åŠ¨
cd backend
venv\Scripts\activate
uvicorn app.main:app --reload
```

---

### æ­¥éª¤ 5: å°é¢æµ‹è¯•

#### 5.1 åˆ›å»ºæµ‹è¯•æœºå™¨äºº

1. **äº¤æ˜“æœºå™¨äºº** â†’ **åˆ›å»ºæœºå™¨äºº**
2. è®¾ç½®**æå°**çš„å‚æ•°:
   - **æ¯å•æŠ•èµ„**: $10 (æœ€å°é‡‘é¢)
   - **æœ€å¤§æŒä»“**: $50
   - **æ æ†**: 1x (ä¸ä½¿ç”¨æ æ†)
   - **æ­¢æŸæ¯”ä¾‹**: 5%
3. é€‰æ‹©æµåŠ¨æ€§å¥½çš„äº¤æ˜“å¯¹: `BTC-USDT`

#### 5.2 è§‚å¯Ÿè¿è¡Œ

- æŸ¥çœ‹æ˜¯å¦èƒ½æ­£å¸¸å¼€ä»“
- æ£€æŸ¥è®¢å•æ˜¯å¦åœ¨ OKX å®˜ç½‘æ˜¾ç¤º
- éªŒè¯æŒä»“æ•°æ®æ˜¯å¦ä¸€è‡´
- ç¡®è®¤å¹³ä»“åŠŸèƒ½æ­£å¸¸

#### 5.3 éªŒè¯æˆåŠŸæ ‡å‡†

âœ… èƒ½æ­£å¸¸è¿æ¥ OKX API
âœ… èƒ½æ­£å¸¸ä¸‹å• (åœ¨ OKX å®˜ç½‘çœ‹åˆ°è®¢å•)
âœ… æŒä»“æ•°æ®å‡†ç¡®
âœ… èƒ½æ­£å¸¸å¹³ä»“
âœ… ä½™é¢å˜åŒ–æ­£ç¡®

---

## ğŸ”§ å¸¸è§é—®é¢˜

### 1. åˆ‡æ¢å®ç›˜å,æµ‹è¯•è¿æ¥å¤±è´¥

**å¯èƒ½åŸå› **:
- API æƒé™ä¸è¶³
- IP ä¸åœ¨ç™½åå•
- ä»£ç†é…ç½®é—®é¢˜

**è§£å†³æ–¹æ³•**:
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
docker-compose exec backend env | grep OKX

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs backend | grep -i "okx\|sandbox"

# ç¡®è®¤æ˜¾ç¤º: "âš ï¸ ä½¿ç”¨ OKX çœŸå®ç›˜ç¯å¢ƒ"
```

### 2. å®ç›˜å’Œæ¨¡æ‹Ÿç›˜ API å¯†é’¥ææ··äº†

**æ£€æŸ¥æ–¹æ³•**:
- æ¨¡æ‹Ÿç›˜ API: OKX â†’ æ¨¡æ‹Ÿäº¤æ˜“ â†’ API ç®¡ç†
- å®ç›˜ API: OKX â†’ API ç®¡ç†

**å»ºè®®**:
- ç»™ API å¯†é’¥å‘½ååŒºåˆ†,å¦‚ `TradingBot-Demo` å’Œ `TradingBot-Real`

### 3. åˆ‡æ¢åè®¢å•æ²¡æœ‰æ‰§è¡Œ

**æ£€æŸ¥æ¸…å•**:
```bash
# 1. ç¡®è®¤ç¯å¢ƒå˜é‡
grep OKX_IS_DEMO .env
# åº”è¯¥æ˜¾ç¤º: OKX_IS_DEMO=false

# 2. ç¡®è®¤æœåŠ¡å·²é‡å¯
docker-compose ps

# 3. æŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs backend | tail -50
```

### 4. æƒ³åˆ‡å›æ¨¡æ‹Ÿç›˜

**æ­¥éª¤**:
```bash
# 1. ä¿®æ”¹ .env
vim .env
# æ”¹ä¸º: OKX_IS_DEMO=true

# 2. é‡å¯åç«¯
docker-compose restart backend

# 3. åœ¨å‰ç«¯é‡æ–°æ·»åŠ æ¨¡æ‹Ÿç›˜ API
# (å» OKX æ¨¡æ‹Ÿäº¤æ˜“è·å– API)
```

---

## ğŸ“Š å®ç›˜å’Œæ¨¡æ‹Ÿç›˜å…±å­˜æ–¹æ¡ˆ

å¦‚æœæƒ³åŒæ—¶ä½¿ç”¨æ¨¡æ‹Ÿç›˜å’Œå®ç›˜,æœ‰ä¸¤ç§æ–¹æ¡ˆ:

### æ–¹æ¡ˆ 1: ä½¿ç”¨ä¸¤å¥—ç¯å¢ƒ (æ¨è)

```bash
# å¼€å‘/æµ‹è¯•ç¯å¢ƒ - æ¨¡æ‹Ÿç›˜
OKX_IS_DEMO=true

# ç”Ÿäº§ç¯å¢ƒ - å®ç›˜
OKX_IS_DEMO=false
```

### æ–¹æ¡ˆ 2: ä»£ç å±‚é¢æ§åˆ¶ (éœ€è¦ä¿®æ”¹ä»£ç )

åœ¨å‰ç«¯æ·»åŠ "æ¨¡æ‹Ÿç›˜/å®ç›˜"åˆ‡æ¢å¼€å…³,ç„¶åä¿®æ”¹:

1. å‰ç«¯è¡¨å•æ·»åŠ  `is_demo` å­—æ®µ
2. æ•°æ®åº“ `exchange_account` è¡¨æ·»åŠ  `is_demo` åˆ—
3. API è°ƒç”¨æ—¶ä¼ é€’ `is_testnet` å‚æ•°

**æ³¨æ„**: è¿™éœ€è¦æ”¹åŠ¨è¾ƒå¤šä»£ç ,ä¸æ¨èåˆæœŸä½¿ç”¨ã€‚

---

## âš ï¸ é£é™©è­¦å‘Š

### å®ç›˜äº¤æ˜“é£é™©

1. **èµ„é‡‘é£é™©**: ä½¿ç”¨çœŸå®èµ„é‡‘,å¯èƒ½äºæŸ
2. **æ æ†é£é™©**: æ æ†ä¼šæ”¾å¤§ç›ˆäº
3. **ç½‘ç»œé£é™©**: ç½‘ç»œä¸­æ–­å¯èƒ½å¯¼è‡´æ— æ³•åŠæ—¶æ­¢æŸ
4. **ç­–ç•¥é£é™©**: ç­–ç•¥å¯èƒ½ä¸é€‚åº”å¸‚åœºå˜åŒ–
5. **API é£é™©**: API å¯†é’¥æ³„éœ²å¯èƒ½å¯¼è‡´èµ„é‡‘æŸå¤±

### å®‰å…¨å»ºè®®

1. **å°é¢èµ·æ­¥**: ç”¨å°‘é‡èµ„é‡‘æµ‹è¯•
2. **è®¾ç½®æ­¢æŸ**: ä¸¥æ ¼çš„æ­¢æŸç­–ç•¥
3. **é™åˆ¶ä»“ä½**: ä¸è¦æ»¡ä»“æ“ä½œ
4. **åˆ†æ•£é£é™©**: ä¸è¦æŠŠæ‰€æœ‰èµ„é‡‘æ”¾åœ¨ä¸€ä¸ªç­–ç•¥
5. **å®šæœŸæ£€æŸ¥**: æ¯å¤©æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
6. **ä¿æŠ¤ API**:
   - ä¸è¦åˆ†äº« API å¯†é’¥
   - ç»‘å®š IP ç™½åå•
   - ä¸å¼€å¯æå¸æƒé™
   - å®šæœŸæ›´æ¢å¯†é’¥

### æ¨èåšæ³•

1. **ç¬¬ä¸€å‘¨**: æ¨¡æ‹Ÿç›˜æµ‹è¯•
2. **ç¬¬äºŒå‘¨**: $50-100 å®ç›˜å°é¢æµ‹è¯•
3. **ç¬¬ä¸‰å‘¨**: å¦‚æœç¨³å®š,é€æ­¥å¢åŠ åˆ° $500
4. **ä¸€ä¸ªæœˆå**: æ ¹æ®æ”¶ç›Šæƒ…å†µå†³å®šæ˜¯å¦å¢åŠ èµ„é‡‘

---

## ğŸ“ æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **æ¨¡æ‹Ÿç›˜/å®ç›˜ç”± `.env` çš„ `OKX_IS_DEMO` æ§åˆ¶**
2. **å‰ç«¯åªéœ€å¡«å†™ API å¯†é’¥,ä¸éœ€è¦é€‰æ‹©æ¨¡æ‹Ÿ/å®ç›˜**
3. **åˆ‡æ¢å®ç›˜åªéœ€ä¸¤æ­¥**:
   - è®¾ç½® `OKX_IS_DEMO=false`
   - åœ¨å‰ç«¯å¡«å†™å®ç›˜ API å¯†é’¥
4. **å¿…é¡»é‡å¯åç«¯æœåŠ¡**æ‰èƒ½ç”Ÿæ•ˆ
5. **ç”¨å°é¢èµ„é‡‘æµ‹è¯•**

### å¿«é€Ÿåˆ‡æ¢æµç¨‹

```bash
# åˆ‡æ¢åˆ°å®ç›˜
echo "OKX_IS_DEMO=false" >> .env
docker-compose restart backend

# åˆ‡æ¢å›æ¨¡æ‹Ÿç›˜
echo "OKX_IS_DEMO=true" >> .env
docker-compose restart backend
```

### éªŒè¯å½“å‰ç¯å¢ƒ

```bash
# æ–¹æ³• 1: æŸ¥çœ‹ç¯å¢ƒå˜é‡
docker-compose exec backend env | grep OKX_IS_DEMO

# æ–¹æ³• 2: æŸ¥çœ‹æ—¥å¿—
docker-compose logs backend | grep -i sandbox

# æ¨¡æ‹Ÿç›˜æ˜¾ç¤º: "âœ… ä½¿ç”¨ OKX æ¨¡æ‹Ÿç›˜ç¯å¢ƒ"
# å®ç›˜æ˜¾ç¤º: "âš ï¸ ä½¿ç”¨ OKX çœŸå®ç›˜ç¯å¢ƒ"
```

---

**æœ€åæé†’**: å®ç›˜äº¤æ˜“æœ‰é£é™©,å…¥å¸‚éœ€è°¨æ…!å»ºè®®å……åˆ†æµ‹è¯•åå†ä½¿ç”¨å®ç›˜,å¹¶å§‹ç»ˆä¿æŒé£é™©æ„è¯†ã€‚

---

**æ–‡æ¡£æ›´æ–°**: 2025-01-11
